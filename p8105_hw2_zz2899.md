Homework 2
================
Zoey Zhao
10/5/2021

``` r
#install.packages("plu")
library(tidyverse)
library(readxl)
library(plu)
```

## Problem 1

Read and clean the Mr. Trash Wheel sheet

``` r
trash_data <- 
  #read the excel and let it contain data entries only
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = 1, range = "A2:N408")%>%
  #use reasonable variable names
  janitor::clean_names()%>%
  #omit rows that do not include dumpster-specific data
  drop_na(dumpster)%>%
  #round the number of sports balls to the nearest integer
  mutate(sports_balls = round(sports_balls, digits = 0))
```

Read and clean precipitation data for 2018

``` r
pre2018 <- 
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = 5, range = "A2:B14")%>%
  #omit rows without precipitation data
  drop_na(Total)%>%
  #add a variable for year
  mutate(year = 2018)

#Read and clean precipitation data for 2019
pre2019 <- 
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = 4, range = "A2:B14")%>%
  #omit rows without precipitation data
  drop_na(Total)%>%
  #add a variable for year
  mutate(year = 2019)

#combine precipitation datasets
pre_data <- 
  bind_rows(pre2018, pre2019)%>%
  #convert month to a character variable
  mutate(Month = month.name[Month])
```

The data set `trash_data` has 14 observations including the dumpster,
month, year, date, weight\_tons, volume\_cubic\_yards, plastic\_bottles,
polystyrene, cigarette\_butts, glass\_bottles, grocery\_bags,
chip\_bags, sports\_balls, homes\_powered. It has a total of 344 rows
and 14 columns. `month` is a character variable (e.g. “January”,
“February”, “March”), `year` is a numeric variable (e.g. 2017), the
variable `date` looks like yyyy-mm-dd, `weight_tons` is a numeric
variable accurate to two decimal places, `homes_powered` is a numeric
variable accurate to five decimal places, other variables are all
numeric variables of integers. The data set `pre_data` has 3
observations including the Month, Total, year. It has a total of 18 rows
and 3 columns. `month` is a character variable (e.g. “January”,
“February”, “March”), `year` is a numeric variable that only contains
2018 and 2019, and `Total` is a numeric variable accurate to two decimal
places.

For available data, total precipitation in 2018 is 70.33, and the median
number of sports balls in a dumpster in 2019 is 8.5.

## Problem 2

Read and clean the data in `pols-month.csv`:

``` r
pols_month <- 
  read_csv("./data/pols-month.csv")%>%
  #break up the variable mon into variables year, month, and day
  separate(mon, into = c("year", "month", "day"), sep = "-")%>%
  #change variables year, month, and day to integers
  mutate(year = as.numeric(year))%>%
  mutate(month = as.numeric(month))%>%
  mutate(day = as.numeric(day))%>%
  #replace month number with month name
  mutate(month = month.name[month])%>%
  #create a president variable taking values gop and dem
  mutate(president = case_when(prez_gop == 1 ~ "gop",
                               prez_gop == 0 ~ "dem"))%>%
  #remove prez_dem and prez_gop; and remove the day variable
  select(-prez_gop, -prez_dem, -day)%>%
  #arrange according to year and month
  arrange(year, month)
```

Read and clean the data in `snp.csv`:

``` r
snp_data <- 
  read_csv("./data/snp.csv")%>%
  #break up the variable date into variables month, day, and year
  separate(date, into = c("month", "day", "year"), sep = "/")%>%
  #change variables month, day, and year to integers
  mutate(month = as.numeric(month))%>%
  mutate(day = as.numeric(day))%>%
  mutate(year = as.numeric(year))%>%
  #replace month number with month name
  mutate(month = month.name[as.numeric(month)])%>%
  #change year to 4 digits
  mutate(year = case_when(year > 20 ~ year + 1900,
                          year < 20 ~ year + 2000))%>%
  #arrange according to year and month
  arrange(year, month)%>%
  #remove the day variable and organize so that year and month are the leading columns
  select(year, everything(), -day)
```

Read and tidy the data in `unemployment.csv`:

``` r
unemployment <- 
  read_csv("./data/unemployment.csv")%>%
  #switching from “wide” to “long” format
  pivot_longer(Jan:Dec,
               names_to = "month",
               values_to = "unemployment_percentage")%>%
  #change month from abbreviation to full name
  mutate(month = month.name[match(month, month.abb)])%>%
  #change the column name "Year" to "year"
  mutate(year = Year)%>%
  select(year, everything(), -Year)%>%
  #arrange according to year and month
  arrange(year, month)
```

Merging `snp_data` into `pols_month`, and merging `unemployment` into
the result:

``` r
pols_snp_unemployment <- 
  left_join(pols_month, snp_data, by = c("year", "month"))%>%
  left_join(unemployment, by = c("year", "month"))
```

The data set `pols_month` has 822 rows and 9 columns with column names:
year, month, gov\_gop, sen\_gop, rep\_gop, gov\_dem, sen\_dem, rep\_dem,
president. Range of year is (1947, 2015).  
The data set `snp_data` has 787 rows and 3 columns with column names:
year, month, close. Range of year is (1950, 2015).  
The data set `unemployment` has 816 rows and 3 columns with column
names: year, month, unemployment\_percentage. Range of year is (1948,
2015).  
The final resulting data set `pols_snp_unemployment` has 822 rows and 11
columns with column names: year, month, gov\_gop, sen\_gop, rep\_gop,
gov\_dem, sen\_dem, rep\_dem, president, close,
unemployment\_percentage. Range of year is (1947, 2015)

## Problem 3

Load and tidy the data:

``` r
baby_names <- 
  read_csv("./data/Popular_Baby_Names.csv")%>%
  #use reasonable variable names
  janitor::clean_names()%>%
  #rewrite abbreviated names in the variable ethnicity
  mutate(ethnicity = case_when(
    ethnicity == "ASIAN AND PACI" ~ "ASIAN AND PACIFIC ISLANDER",
    ethnicity == "BLACK NON HISP" ~ "BLACK NON HISPANIC",
    ethnicity == "WHITE NON HISP" ~ "WHITE NON HISPANIC",
    TRUE ~ ethnicity))%>%
  #change all strings in childs_first_name to capitalized form
  mutate(childs_first_name = capitalize(tolower(childs_first_name)))%>%
  #remove duplicated rows
  distinct()
```

Produce a well-structured, reader-friendly table showing the rank in
popularity of the name “Olivia” as a female baby name over time:

``` r
Olivia_table <- 
  #take all rows of female babies with name "Olivia"
  filter(baby_names, gender == "FEMALE", childs_first_name == "Olivia")%>%
  #select necessary rows
  select(year_of_birth, ethnicity, rank)%>%
  #produce a table of rank of the name "Olivia" in different ethnicities over time
  pivot_wider(names_from = "ethnicity", values_from = "rank")%>%
  #arrange rows to have an increasing year_of_birth
  arrange(year_of_birth)

Olivia_table
```

    ## # A tibble: 6 × 5
    ##   year_of_birth `ASIAN AND PACIFIC… `BLACK NON HISPA… HISPANIC `WHITE NON HISPA…
    ##           <dbl>               <dbl>             <dbl>    <dbl>             <dbl>
    ## 1          2011                   4                10       18                 2
    ## 2          2012                   3                 8       22                 4
    ## 3          2013                   3                 6       22                 1
    ## 4          2014                   1                 8       16                 1
    ## 5          2015                   1                 4       16                 1
    ## 6          2016                   1                 8       13                 1

Produce a similar table showing the most popular name among male
children over time:

``` r
popular_male_name <- 
  #take all rows of male children names with rank 1
  filter(baby_names, gender == "MALE", rank == 1)%>%
  #select necessary rows
  select(year_of_birth, ethnicity, childs_first_name)%>%
  #produce a table showing the most popular names in different ethnicities over time
  pivot_wider(names_from = "ethnicity", values_from = "childs_first_name")%>%
  #arrange rows to have an increasing year_of_birth
  arrange(year_of_birth)

popular_male_name
```

    ## # A tibble: 6 × 5
    ##   year_of_birth `ASIAN AND PACIFIC… `BLACK NON HISPA… HISPANIC `WHITE NON HISPA…
    ##           <dbl> <chr>               <chr>             <chr>    <chr>            
    ## 1          2011 Ethan               Jayden            Jayden   Michael          
    ## 2          2012 Ryan                Jayden            Jayden   Joseph           
    ## 3          2013 Jayden              Ethan             Jayden   David            
    ## 4          2014 Jayden              Ethan             Liam     Joseph           
    ## 5          2015 Jayden              Noah              Liam     David            
    ## 6          2016 Ethan               Noah              Liam     Joseph

For male, white non-hispanic children born in 2016, produce a scatter
plot showing the number of children with a name (y axis) against the
rank in popularity of that name (x axis).
